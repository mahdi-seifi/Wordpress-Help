jQuery(document).ready(function(n){"use strict";var e=n(".yith_wcmap_endpoint_container .endpoints"),t=function(){var t=new Array;n('input[type="hidden"].yith-wcmap-order-endpoints',e).each(function(e){n(this).val()&&(t[e]=n(this).val())}),n("input.endpoints-order").val(t.join(","))};e.sortable({cursor:"move",scrollSensitivity:10,items:"> .endpoint:not('adding')",tolerance:"pointer",axis:"y",stop:function(n,e){t()}}),n(document).on("click",".open-options",function(){n(this).toggleClass("fa-chevron-down").toggleClass("fa-chevron-up"),n(this).closest(".endpoint").find(".options").slideToggle()});var i=0;n(document).on("click",".add-endpoint",function(t){t.stopPropagation();var o=n(this).find(".new-endpoint-form").clone(!1),d="yith-wcmap-new-endpoint-"+i++,a=(o.find('label[for="yith-wcmap-new-endpoint"]').attr("for",d),o.find("#yith-wcmap-new-endpoint").attr("id",d));n(this).before(o),e.find("> .new-endpoint-form").wrap('<li class="endpoint adding"></li>').show(),a.on("keyup",c)});var o=!1,c=function(e){var t=n(this),i=t.val(),c=t.closest(".adding"),d=c.find(".error-msg"),a=n("input.endpoints-order").val().split(","),r=c.find(".yith-wcmap-order-endpoints"),s=c.find(".add-endpoint-button");return o&&o.abort(),c.find(".checking").html(""),s.attr("disabled","disabled"),i.length<3?!1:-1!==n.inArray(i,a)?(c.find(".checking").html(ywcmap.error_icon),d.html(ywcmap.error_msg),!1):void(o=n.ajax({url:ywcmap.ajaxurl,data:{endpoint_name:i,action:ywcmap.action_check},dataType:"json",beforeSend:function(){r.val(""),c.find(".checking").html(ywcmap.loading)},success:function(n){return n.error?(c.find(".checking").html(ywcmap.error_icon),d.html(ywcmap.error_msg),!1):(d.html(""),c.find(".checking").html(ywcmap.checked),s.removeAttr("disabled"),r.val(n.endpoint),void 0)}}))};n(document).on("click",".add-endpoint-button",function(n){t()});var d=n(document).find(".hide-show-check");d.on("change",function(){var e=n(this).closest(".endpoint").find(".hide-show-link");n(this).is(":checked")?e.html(ywcmap.hide_lbl):e.html(ywcmap.show_lbl)}),n(document).on("click",".hide-show-link",function(e){e.preventDefault();var t=n(this).closest(".endpoint").find(".hide-show-check");t.is(":checked")?(t.prop("checked",!1),n(this).html(ywcmap.show_lbl)):(t.prop("checked",!0),n(this).html(ywcmap.hide_lbl))}),n(document).on("click",".remove-link",function(e){e.preventDefault();var i=n(this),o=i.data("endpoint");if("undefined"==typeof o||!o)return!1;var c=confirm(ywcmap.remove_alert);return 1!=c?!1:void n.ajax({url:ywcmap.ajaxurl,data:{endpoint:o,action:ywcmap.action_remove},dataType:"json",success:function(n){n.success&&(i.closest(".endpoint").remove(),t())}})})});